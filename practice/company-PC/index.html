<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title></title>
    <!--<script type="text/javascript"-->
            <!--src="https://resjrprd.suning.com/finance/public/v1/scripts/lib/zepto/zepto.temple.compo.js"></script>-->
    <!--<script type="text/javascript"-->
            <!--src="https://lcres.suning.com/common/scripts/app/common/lib/exp.min.js?3.29"></script>-->
    <script src="http://apps.bdimg.com/libs/jquery/1.11.1/jquery.min.js"></script>
</head>
<body>
<input type="text" class="hehe"/>
<script type="text/javascript">

    function inputTrim(opt) {//对input中的非法字符进行修剪
        //设置光标位置函数
        function setCursorPosition(ctrl, pos) {
            if (ctrl.setSelectionRange) {
                ctrl.focus();
                ctrl.setSelectionRange(pos, pos);
            } else if (ctrl.createTextRange) {
                var range = ctrl.createTextRange();
                range.collapse(true);
                range.moveEnd('character', pos);
                range.moveStart('character', pos);
                range.select();
            }
        }
        //获取光标位置函数
        function getPositionForInput(ctrl) {
            var CaretPos = 0;
            if(ctrl.selectionStart || ctrl.selectionStart == '0') {// Firefox support
                CaretPos = ctrl.selectionStart;
            } else if (document.selection) { // IE Support
                ctrl.focus();
                var Sel = document.selection.createRange();
                Sel.moveStart('character', -ctrl.value.length);
                CaretPos = Sel.text.length;
            }
            return CaretPos;
        }

        var type = opt.element ? opt.element.attr('type') : '';

        function trim() {
            var el = opt.element,
                    val = opt.element.val() || opt.element.text(),
                    tip = opt.tip,
                    trimReg = opt.trimReg;
            if (tip == val) {
                val = "";
            }
            if (trimReg) {
                var arr = val.match(trimReg),
                        value = arr ? arr.join("") : "";
                //重复一次
                arr = value.match(trimReg),
                        value = arr ? arr[0] : "";
                if (value != val) {
                    //输入错误时不设置光标位置，否则type="number"时报错
                    if (type == 'number') {
                        el.val(value);
                    } else {
                        var pos = getPositionForInput(el[0]);
                        el.val(value);
                        setCursorPosition(el[0], pos - 1);
                    }
                }
            }
        }

        opt.element.on("input", function () {
            trim();
        });
    }
    inputTrim({element: $(".hehe"), trimReg: /[1-9]\d*(?:\.\d{1,2}|\.)?/ig});
</script>
<br/>
input事件: <input type="text" id="box"/><br/>
keypress事件: <input type="text" id="box1"/><br/>
keydown事件: <input type="text" id="box2"/><br/>
keyup事件: <input type="text" id="box5"/><br/>
change事件: <input type="text" id="box3"/><br/>
blur事件: <input type="text" id="box4"/><br/>
<script>
    //onkeypress="return is_number(event)"
    $("#box").on("input", function(e) {
        console.log($(this).val())
        console.debug(e.charCode ||  e.keyCode)
    })
    $("#box1").on("keypress", function(e) {
        console.log($(this).val())
        console.debug(e.charCode ||  e.keyCode)
    })
    $("#box2").on("keydown", function(e) {
        console.log($(this).val())
        console.debug(e.charCode ||  e.keyCode)
    })
    $("#box3").on("change", function(e) {
        console.log($(this).val())
        console.debug(e.charCode ||  e.keyCode)
    })
    $("#box4").on("blur", function(e) {
        console.log($(this).val())
        console.debug(e.charCode ||  e.keyCode)
    })
    $("#box5").on("keyup", function(e) {
        console.log($(this).val())
        console.debug(e.charCode ||  e.keyCode)
    })
</script>
<input type="text" id="bb"/>        <button id="ba">获取光标位置</button>
<script>
    //获取光标位置函数
    function getPositionForInput(ctrl) {
        var CaretPos = 0;
        if (document.selection) { // IE Support
            ctrl.focus();
            var Sel = document.selection.createRange();
            Sel.moveStart('character', -ctrl.value.length);
            CaretPos = Sel.text.length;
        } else if (ctrl.selectionStart || ctrl.selectionStart == '0') {// Firefox support
            CaretPos = ctrl.selectionStart;
        }
        return CaretPos;
    }
    $("#bb").on("input", function() {
        console.info(getPositionForInput(document.getElementById("bb")))
    })
</script>
</body>
</html>